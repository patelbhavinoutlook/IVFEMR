<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FertyFlow EMR/HIS System - Preview</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
</head>
<body class="bg-gray-50">
    <div class="min-h-screen">
        <!-- Header -->
        <header class="bg-blue-600 text-white shadow-lg">
            <div class="container mx-auto px-6 py-4">
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-3">
                        <i data-lucide="heart" class="h-8 w-8"></i>
                        <div>
                            <h1 class="text-2xl font-bold">FertyFlow</h1>
                            <p class="text-blue-200 text-sm">Enterprise EMR/HIS System</p>
                        </div>
                    </div>
                    <div class="text-right">
                        <p class="font-medium">Super Admin</p>
                        <p class="text-blue-200 text-sm">FertyCare IVF Centers</p>
                    </div>
                </div>
            </div>
        </header>

        <div class="container mx-auto px-6 py-8">
            <!-- Welcome Section -->
            <div class="bg-white rounded-lg shadow-md p-8 mb-8">
                <h2 class="text-3xl font-bold text-gray-900 mb-4">üéâ Welcome to FertyFlow EMR/HIS System</h2>
                <p class="text-gray-600 text-lg mb-6">Your enterprise-grade Electronic Medical Records and Hospital Information System for IVF clinics is now running successfully!</p>
                
                <!-- System Status -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                    <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                        <div class="flex items-center space-x-3">
                            <div class="p-2 bg-green-100 rounded-full">
                                <i data-lucide="server" class="h-6 w-6 text-green-600"></i>
                            </div>
                            <div>
                                <h3 class="font-semibold text-green-900">Backend API</h3>
                                <p class="text-green-700 text-sm">Running on Port 5000</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                        <div class="flex items-center space-x-3">
                            <div class="p-2 bg-blue-100 rounded-full">
                                <i data-lucide="database" class="h-6 w-6 text-blue-600"></i>
                            </div>
                            <div>
                                <h3 class="font-semibold text-blue-900">PostgreSQL DB</h3>
                                <p class="text-blue-700 text-sm">25+ Tables Configured</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-purple-50 border border-purple-200 rounded-lg p-4">
                        <div class="flex items-center space-x-3">
                            <div class="p-2 bg-purple-100 rounded-full">
                                <i data-lucide="shield-check" class="h-6 w-6 text-purple-600"></i>
                            </div>
                            <div>
                                <h3 class="font-semibold text-purple-900">Security</h3>
                                <p class="text-purple-700 text-sm">JWT + Role-Based Access</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Test Login Section -->
            <div class="bg-white rounded-lg shadow-md p-8 mb-8">
                <h3 class="text-2xl font-bold text-gray-900 mb-6">üîê Test Authentication System</h3>
                
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <!-- Login Form -->
                    <div>
                        <form id="loginForm" class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Username</label>
                                <input type="text" id="username" value="admin" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Password</label>
                                <input type="password" id="password" value="admin123" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                            <button type="submit" class="w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500">
                                Test Login
                            </button>
                        </form>
                    </div>

                    <!-- Response Display -->
                    <div>
                        <h4 class="text-lg font-semibold text-gray-900 mb-3">API Response:</h4>
                        <div id="response" class="bg-gray-100 border rounded-md p-4 h-48 overflow-auto">
                            <p class="text-gray-500">Click "Test Login" to see the API response...</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- System Features -->
            <div class="bg-white rounded-lg shadow-md p-8">
                <h3 class="text-2xl font-bold text-gray-900 mb-6">üè• System Features</h3>
                
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <div class="border border-gray-200 rounded-lg p-4">
                        <div class="flex items-center space-x-3 mb-3">
                            <i data-lucide="users" class="h-6 w-6 text-blue-600"></i>
                            <h4 class="font-semibold">Multi-Company Support</h4>
                        </div>
                        <p class="text-gray-600 text-sm">Support for multiple healthcare companies and IVF clinic chains</p>
                    </div>

                    <div class="border border-gray-200 rounded-lg p-4">
                        <div class="flex items-center space-x-3 mb-3">
                            <i data-lucide="building-2" class="h-6 w-6 text-green-600"></i>
                            <h4 class="font-semibold">Multi-Clinic Access</h4>
                        </div>
                        <p class="text-gray-600 text-sm">Each company can manage multiple clinics with separate data isolation</p>
                    </div>

                    <div class="border border-gray-200 rounded-lg p-4">
                        <div class="flex items-center space-x-3 mb-3">
                            <i data-lucide="heart" class="h-6 w-6 text-red-600"></i>
                            <h4 class="font-semibold">IVF Treatment Tracking</h4>
                        </div>
                        <p class="text-gray-600 text-sm">Complete IVF cycle management and embryology lab tracking</p>
                    </div>

                    <div class="border border-gray-200 rounded-lg p-4">
                        <div class="flex items-center space-x-3 mb-3">
                            <i data-lucide="shield" class="h-6 w-6 text-purple-600"></i>
                            <h4 class="font-semibold">Role-Based Security</h4>
                        </div>
                        <p class="text-gray-600 text-sm">10 predefined roles from Super Admin to specific clinic staff</p>
                    </div>

                    <div class="border border-gray-200 rounded-lg p-4">
                        <div class="flex items-center space-x-3 mb-3">
                            <i data-lucide="credit-card" class="h-6 w-6 text-yellow-600"></i>
                            <h4 class="font-semibold">Billing System</h4>
                        </div>
                        <p class="text-gray-600 text-sm">Clinic-specific billing with tax management and invoice generation</p>
                    </div>

                    <div class="border border-gray-200 rounded-lg p-4">
                        <div class="flex items-center space-x-3 mb-3">
                            <i data-lucide="package" class="h-6 w-6 text-orange-600"></i>
                            <h4 class="font-semibold">Inventory Management</h4>
                        </div>
                        <p class="text-gray-600 text-sm">Multi-location stock management with pharmacy integration</p>
                    </div>
                </div>
            </div>

            <!-- API Endpoints -->
            <div class="bg-white rounded-lg shadow-md p-8 mt-8">
                <h3 class="text-2xl font-bold text-gray-900 mb-6">üîó Available API Endpoints</h3>
                
                <div class="space-y-4">
                    <div class="border-l-4 border-green-500 pl-4">
                        <code class="text-green-700 font-mono">GET /health</code>
                        <p class="text-gray-600 text-sm">System health check</p>
                    </div>
                    
                    <div class="border-l-4 border-blue-500 pl-4">
                        <code class="text-blue-700 font-mono">POST /api/auth/login</code>
                        <p class="text-gray-600 text-sm">User authentication with JWT token generation</p>
                    </div>
                    
                    <div class="border-l-4 border-purple-500 pl-4">
                        <code class="text-purple-700 font-mono">GET /api/auth/profile</code>
                        <p class="text-gray-600 text-sm">Get authenticated user profile</p>
                    </div>
                    
                    <div class="border-l-4 border-orange-500 pl-4">
                        <code class="text-orange-700 font-mono">POST /api/auth/logout</code>
                        <p class="text-gray-600 text-sm">User logout and token invalidation</p>
                    </div>
                </div>

                <div class="mt-6 p-4 bg-gray-50 rounded-lg">
                    <p class="text-sm text-gray-600">
                        <strong>Note:</strong> Additional modules (Patients, Treatments, Billing, Inventory) have placeholder endpoints ready for implementation.
                    </p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Initialize Lucide icons
        lucide.createIcons();

        // Login form handler
        document.getElementById('loginForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            const responseDiv = document.getElementById('response');
            
            responseDiv.innerHTML = '<p class="text-blue-600">üîÑ Authenticating...</p>';
            
            try {
                const response = await fetch('/api/auth/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ username, password })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    responseDiv.innerHTML = `
                        <div class="text-green-600">
                            <p class="font-semibold mb-2">‚úÖ Login Successful!</p>
                            <div class="text-sm space-y-1">
                                <p><strong>User:</strong> ${data.user.username}</p>
                                <p><strong>Role:</strong> ${data.user.roles.join(', ')}</p>
                                <p><strong>Company:</strong> ${data.user.companies[0]?.name}</p>
                                <p><strong>Clinic:</strong> ${data.user.clinics[0]?.name}</p>
                                <p><strong>Token:</strong> ${data.accessToken.substring(0, 50)}...</p>
                            </div>
                        </div>
                    `;
                } else {
                    responseDiv.innerHTML = `<p class="text-red-600">‚ùå Login Failed: ${data.error}</p>`;
                }
            } catch (error) {
                responseDiv.innerHTML = `<p class="text-red-600">‚ùå Error: ${error.message}</p>`;
            }
        });
    </script>
</body>
</html>